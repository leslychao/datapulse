marketplace:
  providers:
    WILDBERRIES:
      useSandbox: false
      baseUrl: https://statistics-api.wildberries.ru
      feedbacksBaseUrl: https://feedbacks-api.wildberries.ru
      sandbox:
        baseUrl: https://statistics-api-sandbox.wildberries.ru
        feedbacksBaseUrl: https://feedbacks-api-sandbox.wildberries.ru
      endpoints:
        sales: /api/v1/supplier/sales
        stock: /api/v1/supplier/stocks
        finance: /api/v5/supplier/reportDetailByPeriod
        reviews: /api/v1/questions
      resilience:
        # WB дефолт: «ровная подача» + запас под burst (можно точечно переопределять ниже)
        limitForPeriod: 300        # 300 запросов/мин (пример для категории Marketplace)
        limitRefreshPeriod: 60s
        tokenWaitTimeout: 2s
        maxConcurrentCalls: 16     # держим ниже burst, оставляя запас
        bulkheadWait: 1s
        maxAttempts: 5
        baseBackoff: 200ms
        maxBackoff: 30s
        maxJitter: 500ms
        retryAfterFallback: 1s
      # Опциональные локальные оверрайды на эндпоинт (ключи — sales|stock|finance|reviews)
      resilienceOverrides:
        reviews:
          limitForPeriod: 3
          limitRefreshPeriod: 1s
          tokenWaitTimeout: 2s
          maxConcurrentCalls: 3
          bulkheadWait: 1s
          maxAttempts: 4
          baseBackoff: 200ms
          maxBackoff: 10s
          maxJitter: 300ms
          retryAfterFallback: 1s

    OZON:
      baseUrl: https://api-seller.ozon.ru
      sandbox:
        baseUrl: https://sandbox-api-seller.ozon.ru
      endpoints:
        sales: /v1/analytics/data
        stock: /v4/product/info/stocks
        finance: /v3/finance/transaction/list
        reviews: /v1/review/list
      resilience:
        # Глобальный лимит 50 rps на Client ID — ставим секционный limiter
        limitForPeriod: 50
        limitRefreshPeriod: 1s
        tokenWaitTimeout: 3s
        maxConcurrentCalls: 20
        bulkheadWait: 1s
        maxAttempts: 4
        baseBackoff: 300ms
        maxBackoff: 20s
        maxJitter: 300ms
        retryAfterFallback: 1s
